(this["webpackJsonplocal-web-chat"]=this["webpackJsonplocal-web-chat"]||[]).push([[0],{110:function(e,t){},178:function(e,t,n){},179:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(0),c=n.n(a),s=n(13),i=n.n(s),o=n(19),u=n(29),l=n(88),b=n(218),d=n(214),f=n(215),p=n(219),j=n(216),m=n(217),x=n(211),O=n(213),h=n(35),g=n(41),v="PENDING",y="SUCCESS",w="FAILURE",k=function(e,t){return{type:e,payload:t}};function S(e){var t=function(t){return k("".concat(e,"/").concat(v),t)};return t.type=e,t.pending="".concat(e,"/").concat(v),t.success="".concat(e,"/").concat(y),t.failure="".concat(e,"/").concat(w),t}var M=S("users/CREATE_USER"),I={resources:[]},C=Object(g.a)((function(e){return e.users}),(function(e){return e.resources})),B=n(208),N=Object(B.a)({root:{display:"flex",flexDirection:"column"},username:function(e){return{display:"flex",height:"25px !important",flexDirection:e.isMine?"row-reverse":"row",position:"relative",top:5,"& p":{padding:"0 .5rem",color:"#41b3a3",fontWeight:"bold",fontStyle:"italic"}}},container:function(e){return{display:"flex",justifyContent:"flex-end",alignItems:"center",flexDirection:e.isMine?"row":"row-reverse"}},message:function(e){var t=e.isMine;return{position:"relative",borderRadius:".75rem",padding:".25rem .5rem",wordBreak:"break-word",flex:"1 10px",maxWidth:"fit-content",backgroundColor:t?"#3f51b5":"#c5cbe3",color:"#fff","&:before":{display:e.isLastMessage?"block":"none",content:"''",position:"absolute",left:t?void 0:0,right:t?0:void 0,bottom:0,width:".75rem",height:".75rem",zIndex:-1,backgroundColor:t?"#3f51b5":"#c5cbe3"}}},iconPlaceholder:{alignSelf:"flex-end",flex:"0 35px",width:35,height:35}}),E=function(e){var t=e.message,n=t.createdBy,c=t.message,s=e.isFirstMessage,i=e.isLastMessage,u=Object(a.useContext)(Q),l=Object(o.d)(C),b=n===u,d=N({isMine:b,isLastMessage:i}),f=Object(a.useMemo)((function(){return l.find((function(e){return e.id===n}))}),[l]);return Object(r.jsxs)("div",{className:d.root,children:[s&&Object(r.jsxs)("div",{className:d.username,children:[Object(r.jsx)("div",{className:d.iconPlaceholder}),Object(r.jsx)(x.a,{variant:"body2",children:f&&f.username})]}),Object(r.jsxs)("div",{className:d.container,children:[Object(r.jsx)("div",{className:d.message,children:Object(r.jsx)(x.a,{style:{wordWrap:"break-all"},children:c})}),Object(r.jsx)("div",{className:d.iconPlaceholder,children:i&&Object(r.jsx)(O.a,{color:b?"primary":"secondary",fontSize:"large"})})]})]})},L=c.a.memo(E),D=S("messages/POST_MESSAGE"),T=S("messages/LOAD_MESSAGES"),P={resources:null},R=function(e){return e.messages},W=Object(g.a)(R,(function(e){return e.resources})),F=(Object(g.a)(R,(function(e){return e.meta})),n(40)),A=Object(B.a)((function(e){var t;return{container:{position:"relative"},appBar:{borderTop:"1px solid rgba(0, 0, 0, .12)",backgroundColor:"#fafafa",position:"fixed",boxSizing:"border-box",width:"100%",maxWidth:"450px",bottom:0},messages:(t={margin:"0 1rem",paddingBottom:61},Object(F.a)(t,"".concat(e.breakpoints.up("xs")," and (orientation: landscape)"),{paddingBottom:53}),Object(F.a)(t,e.breakpoints.up("sm"),{paddingBottom:69}),t),form:{display:"flex",alignItems:"center",width:"100%"},button:{marginLeft:".5rem"}}})),z=function(){var e=Object(o.c)(),t=Object(a.useState)(""),n=Object(u.a)(t,2),c=n[0],s=n[1],i=Object(a.useState)(-1),l=Object(u.a)(i,2),b=l[0],x=l[1],O=Object(a.useRef)(null),h=Object(a.useRef)(null),g=Object(o.d)(W,o.b),v=Object(a.useContext)(Q),y=A();Object(a.useLayoutEffect)((function(){g&&(window.innerHeight-h.current.getBoundingClientRect().bottom>=-75&&setTimeout((function(){return O.current.scrollIntoView({behavior:"smooth"})}),50),x((function(e){return e+1})))}),[g]);var w=Object(a.useMemo)((function(){return b>0?(g||[]).slice(-b):[]}),[g,b]);return Object(r.jsxs)("div",{className:y.container,children:[g&&b<g.length&&Object(r.jsx)(d.a,{fullWidth:!0,type:"button",onClick:function(){x((function(e){var t=e+25;return t<=g.length?t:g.length}))},children:"Load more"}),Object(r.jsx)("div",{className:y.messages,ref:h,children:w.map((function(e,t){return Object(r.jsx)(L,{message:e,isLastMessage:!w[t+1]||w[t+1].createdBy!==e.createdBy,isFirstMessage:!w[t-1]||w[t-1].createdBy!==e.createdBy},"by-".concat(e.createdBy,"-at-").concat(e.timestamp))}))}),Object(r.jsx)("div",{ref:O}),Object(r.jsx)(f.a,{position:"static",className:y.appBar,children:Object(r.jsxs)("form",{onSubmit:function(t){t.preventDefault(),c.trim()&&(e(D({createdBy:v,message:c,timestamp:(new Date).getTime()})),setTimeout((function(){return O.current.scrollIntoView({behavior:"smooth"})}),50)),s("")},className:y.form,children:[Object(r.jsx)(p.a,{placeholder:"Message",fullWidth:!0,value:c,onChange:function(e){return s(e.target.value)}}),Object(r.jsx)(j.a,{type:"submit",className:y.button,children:Object(r.jsx)(m.a,{})})]})})]})},U=n(89),G=n(15),_=n.n(G),J=n(65),V=n(21),q=n.n(V),H=Object(B.a)({wrapper:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},form:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},button:{marginTop:".5rem"}}),Y=function(){var e=Object(J.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.a.getItem("users");case 2:if(t=e.sent){e.next=6;break}return e.next=6,q.a.setItem("users",[]);case 6:return e.abrupt("return",t||[]);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(e){var t=e.setId,n=Object(o.c)(),c=Object(a.useState)(""),s=Object(u.a)(c,2),i=s[0],l=s[1],b=H(),f=function(){var e=Object(J.a)(_.a.mark((function e(r){var a,c;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,Y();case 3:a=e.sent,c=Math.max.apply(Math,[0].concat(Object(U.a)(a.map((function(e){return e.id})))))+1,t(c),n(M({users:a,user:{username:i,id:c}}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{className:b.wrapper,children:Object(r.jsxs)("form",{onSubmit:f,className:b.form,children:[Object(r.jsx)(p.a,{required:!0,label:"Username",variant:"outlined",value:i,onChange:function(e){return l(e.target.value)}}),Object(r.jsx)(d.a,{disabled:!i,size:"large",color:"primary",variant:"contained",type:"submit",fullWidth:!0,className:b.button,children:"Enter chat"})]})})},Q=Object(a.createContext)(null),X=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],c=t[1],s=Object(l.a)();return Object(r.jsx)(b.a,{theme:s,children:Object(r.jsx)(Q.Provider,{value:n,children:n?Object(r.jsx)(z,{}):Object(r.jsx)(K,{setId:c})})})},Z=n(23),$=n(44),ee=n(86),te=n(90),ne=n(17),re=n(87),ae=n.n(re),ce=_.a.mark(oe),se=_.a.mark(ue),ie=_.a.mark(le);function oe(){var e,t;return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(ne.c)(W);case 3:return e=n.sent,n.next=6,q.a.getItem("messages");case 6:if(t=n.sent){n.next=10;break}return n.next=10,q.a.setItem("messages",[]);case 10:if(ae()(t||[],e)){n.next=14;break}return n.next=14,Object(ne.b)({type:T.success,payload:t||[]});case 14:n.next=20;break;case 16:return n.prev=16,n.t0=n.catch(0),n.next=20,Object(ne.b)({type:T.failure});case 20:case"end":return n.stop()}}),ce,null,[[0,16]])}function ue(e){var t,n;return _.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,r.next=4,q.a.getItem("messages");case 4:if(r.t0=r.sent,r.t0){r.next=7;break}r.t0=[];case 7:return(n=r.t0).push(t),r.next=11,q.a.setItem("messages",n);case 11:return r.next=13,Object(ne.b)({type:D.success,payload:t});case 13:return r.next=15,Object(ne.b)(T());case 15:r.next=21;break;case 17:return r.prev=17,r.t1=r.catch(1),r.next=21,Object(ne.b)({type:D.failure});case 21:case"end":return r.stop()}}),se,null,[[1,17]])}function le(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.d)(D.pending,ue);case 2:return e.next=4,Object(ne.d)(T.pending,oe);case 4:case"end":return e.stop()}}),ie)}var be=_.a.mark(fe),de=_.a.mark(pe);function fe(e){var t,n,r;return _.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,a.prev=1,n=t.user,r=t.users,a.next=5,q.a.setItem("users",r.concat(n));case 5:return a.next=7,Object(ne.b)({type:M.success,payload:r.concat(n)});case 7:return a.next=9,Object(ne.b)({type:T.pending});case 9:a.next=15;break;case 11:return a.prev=11,a.t0=a.catch(1),a.next=15,Object(ne.b)({type:M.failure});case 15:case"end":return a.stop()}}),be,null,[[1,11]])}function pe(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ne.d)(M.pending,fe);case 2:case"end":return e.stop()}}),de)}var je=_.a.mark(me);function me(){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield([Object(ne.a)(le),Object(ne.a)(pe)],"t0",1);case 1:case"end":return e.stop()}}),je)}var xe=Object($.withReduxStateSync)(Object(Z.combineReducers)({users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M.success:return Object(h.a)(Object(h.a)({},e),{},{resources:t.payload});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T.success:return Object(h.a)(Object(h.a)({},e),{},{resources:t.payload});default:return e}}})),Oe={blacklist:[D.pending,T.pending,M.pending]},he=Object(te.a)(),ge=[Object($.createStateSyncMiddleware)(Oe),he],ve=Object(Z.createStore)(xe,{},Object(ee.composeWithDevTools)(Z.applyMiddleware.apply(void 0,ge)));he.run(me),Object($.initMessageListener)(ve),Object($.initStateWithPrevTab)(ve);var ye=function(){return Object(r.jsx)(o.a,{store:ve,children:Object(r.jsx)(X,{})})},we=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,220)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};n(178);i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(ye,{})}),document.getElementById("root")),we()},85:function(e,t){}},[[179,1,2]]]);
//# sourceMappingURL=main.21020c7a.chunk.js.map