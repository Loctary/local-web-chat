{"version":3,"sources":["lib/actions.js","store/users/actions.js","store/users/reducer.js","pages/Message/styles.js","pages/Message/index.jsx","store/messages/actions.js","store/messages/reducer.js","pages/Chat/styles.js","pages/Chat/index.jsx","pages/CreateUser/styles.js","pages/CreateUser/index.jsx","pages/AppWrapper/index.jsx","store/messages/saga.js","store/users/saga.js","store/sagas.js","store/index.js","pages/index.js","reportWebVitals.js","index.js"],"names":["SUFFIXES","defaultActionMaker","type","payload","asyncAction","base","actionCreator","pending","success","failure","createUserAction","initialState","resources","usersSelector","createSelector","state","users","useStyles","makeStyles","root","display","flexDirection","username","height","isMine","position","top","padding","color","fontWeight","fontStyle","container","justifyContent","alignItems","message","borderRadius","wordBreak","flex","maxWidth","backgroundColor","isLastMessage","content","left","undefined","right","bottom","width","zIndex","iconPlaceholder","alignSelf","Message","createdBy","isFirstMessage","id","useContext","UserIdContext","useSelector","classes","user","useMemo","find","className","Typography","variant","style","wordWrap","AccountCircle","fontSize","React","memo","postMessageAction","loadMessagesAction","messagesReducerSelector","messages","messagesSelector","meta","theme","appBar","borderTop","boxSizing","margin","paddingBottom","breakpoints","up","form","button","marginLeft","Chat","dispatch","useDispatch","useState","setMessage","loaded","setLoaded","chatBottomRef","useRef","messagesRef","shallowEqual","useLayoutEffect","window","innerHeight","current","getBoundingClientRect","setTimeout","scrollIntoView","behavior","prevState","loadedMessages","slice","length","Button","fullWidth","onClick","ref","map","ix","timestamp","Toolbar","onSubmit","e","preventDefault","trim","Date","getTime","TextField","placeholder","value","onChange","target","IconButton","Send","wrapper","marginTop","getUsers","a","localforage","getItem","setItem","CreateUser","setId","setUsername","Math","max","required","label","disabled","size","createContext","App","createMuiTheme","ThemeProvider","Provider","loadMessages","postMessage","select","reduxMessaged","isEqual","put","messagesActions","push","takeEvery","createNewUser","concat","usersActions","fork","rootReducer","withReduxStateSync","combineReducers","action","config","blacklist","sagaMiddleware","createSagaMiddleware","middlewares","createStateSyncMiddleware","store","createStore","composeWithDevTools","applyMiddleware","run","rootSaga","initMessageListener","initStateWithPrevTab","AppWrapper","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.21020c7a.chunk.js","sourcesContent":["export const SUFFIXES = {\n  PENDING: 'PENDING',\n  SUCCESS: 'SUCCESS',\n  FAILURE: 'FAILURE',\n};\n\nconst defaultActionMaker = (type, payload) => ({ type, payload });\n\nexport function asyncAction(base) {\n  const actionCreator = (payload) => defaultActionMaker(`${base}/${SUFFIXES.PENDING}`, payload);\n\n  actionCreator.type = base;\n  actionCreator.pending = `${base}/${SUFFIXES.PENDING}`;\n  actionCreator.success = `${base}/${SUFFIXES.SUCCESS}`;\n  actionCreator.failure = `${base}/${SUFFIXES.FAILURE}`;\n  return actionCreator;\n}\n\nexport function syncAction(base) {\n  const actionCreator = (payload) => defaultActionMaker(base, payload);\n\n  actionCreator.type = base;\n  return actionCreator;\n}\n","import { asyncAction } from 'lib/actions';\n\nexport const createUserAction = asyncAction('users/CREATE_USER');\n","import { createSelector } from 'reselect';\nimport { createUserAction } from 'store/users/actions';\n\nconst initialState = {\n  resources: [],\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case createUserAction.success:\n      return {\n        ...state,\n        resources: action.payload,\n      };\n    default:\n      return state;\n  }\n};\n\nconst usersReducerSelector = (state) => state.users;\n\nexport const usersSelector = createSelector(usersReducerSelector, (users) => users.resources);\n","import { makeStyles } from '@material-ui/core';\n\nexport const useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n  },\n  username: ({ isMine }) => ({\n    display: 'flex',\n    height: '25px !important',\n    flexDirection: isMine ? 'row-reverse' : 'row',\n    position: 'relative',\n    top: 5,\n    '& p': {\n      padding: '0 .5rem',\n      color: '#41b3a3',\n      fontWeight: 'bold',\n      fontStyle: 'italic',\n    },\n  }),\n  container: ({ isMine }) => ({\n    display: 'flex',\n    justifyContent: 'flex-end',\n    alignItems: 'center',\n    flexDirection: isMine ? 'row' : 'row-reverse',\n  }),\n  message: ({ isMine, isLastMessage }) => ({\n    position: 'relative',\n    borderRadius: '.75rem',\n    padding: '.25rem .5rem',\n    wordBreak: 'break-word',\n    flex: '1 10px',\n    maxWidth: 'fit-content',\n    backgroundColor: isMine ? '#3f51b5' : '#c5cbe3',\n    color: '#fff',\n    '&:before': {\n      display: isLastMessage ? 'block' : 'none',\n      content: `''`,\n      position: 'absolute',\n      left: isMine ? undefined : 0,\n      right: isMine ? 0 : undefined,\n      bottom: 0,\n      width: '.75rem',\n      height: '.75rem',\n      zIndex: -1,\n      backgroundColor: isMine ? '#3f51b5' : '#c5cbe3',\n    },\n  }),\n  iconPlaceholder: {\n    alignSelf: 'flex-end',\n    flex: '0 35px',\n    width: 35,\n    height: 35,\n  },\n});\n","import React, { useContext, useMemo } from 'react';\nimport { useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\n\nimport { Typography } from '@material-ui/core';\nimport { AccountCircle } from '@material-ui/icons';\n\nimport { UserIdContext } from 'pages/AppWrapper';\nimport { usersSelector } from 'store/users/reducer';\n\nimport { useStyles } from './styles';\n\nconst Message = ({ message: { createdBy, message }, isFirstMessage, isLastMessage }) => {\n  const id = useContext(UserIdContext);\n  const users = useSelector(usersSelector);\n  const isMine = createdBy === id;\n  const classes = useStyles({ isMine, isLastMessage });\n\n  const user = useMemo(() => users.find(({ id }) => id === createdBy), [users]);\n\n  return (\n    <div className={classes.root}>\n      {isFirstMessage && (\n        <div className={classes.username}>\n          <div className={classes.iconPlaceholder} />\n          <Typography variant=\"body2\">{user && user.username}</Typography>\n        </div>\n      )}\n\n      <div className={classes.container}>\n        <div className={classes.message}>\n          <Typography style={{ wordWrap: 'break-all' }}>{message}</Typography>\n        </div>\n        <div className={classes.iconPlaceholder}>\n          {isLastMessage && <AccountCircle color={isMine ? 'primary' : 'secondary'} fontSize=\"large\" />}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nMessage.propTypes = {\n  message: PropTypes.shape({\n    createdBy: PropTypes.number.isRequired,\n    message: PropTypes.string.isRequired,\n    timestamp: PropTypes.number.isRequired,\n  }).isRequired,\n  isFirstMessage: PropTypes.bool.isRequired,\n  isLastMessage: PropTypes.bool.isRequired,\n};\n\nexport default React.memo(Message);\n","import { asyncAction } from 'lib/actions';\n\nexport const postMessageAction = asyncAction('messages/POST_MESSAGE');\nexport const loadMessagesAction = asyncAction('messages/LOAD_MESSAGES');\n","import { createSelector } from 'reselect';\nimport { loadMessagesAction } from 'store/messages/actions';\n\nconst initialState = {\n  resources: null,\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case loadMessagesAction.success:\n      return {\n        ...state,\n        resources: action.payload,\n      };\n    default:\n      return state;\n  }\n};\n\nconst messagesReducerSelector = (state) => state.messages;\n\nexport const messagesSelector = createSelector(messagesReducerSelector, (messages) => messages.resources);\nexport const messagesMetaSelector = createSelector(messagesReducerSelector, (messages) => messages.meta);\n","import { makeStyles } from '@material-ui/core';\n\nconst MESSAGES_PADDING = 5;\n\nexport const useStyles = makeStyles((theme) => ({\n  container: {\n    position: 'relative',\n  },\n  appBar: {\n    borderTop: '1px solid rgba(0, 0, 0, .12)',\n    backgroundColor: '#fafafa',\n    position: 'fixed',\n    boxSizing: 'border-box',\n    width: '100%',\n    maxWidth: '450px',\n    bottom: 0,\n  },\n  messages: {\n    margin: '0 1rem',\n    paddingBottom: 56 + MESSAGES_PADDING,\n    [`${theme.breakpoints.up('xs')} and (orientation: landscape)`]: {\n      paddingBottom: 48 + MESSAGES_PADDING,\n    },\n    [theme.breakpoints.up('sm')]: {\n      paddingBottom: 64 + MESSAGES_PADDING,\n    },\n  },\n  form: {\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%',\n  },\n  button: {\n    marginLeft: '.5rem',\n  },\n}));\n","import React, { useContext, useLayoutEffect, useMemo, useRef, useState } from 'react';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\n\nimport { Toolbar, TextField, IconButton, Button } from '@material-ui/core';\nimport { Send } from '@material-ui/icons';\n\nimport { UserIdContext } from 'pages/AppWrapper';\nimport Message from 'pages/Message';\n\nimport { postMessageAction } from 'store/messages/actions';\nimport { messagesSelector } from 'store/messages/reducer';\n\nimport { useStyles } from './styles';\n\nconst Chat = () => {\n  const dispatch = useDispatch();\n  const [message, setMessage] = useState('');\n  const [loaded, setLoaded] = useState(-1);\n  const chatBottomRef = useRef(null);\n  const messagesRef = useRef(null);\n\n  const messages = useSelector(messagesSelector, shallowEqual);\n  const id = useContext(UserIdContext);\n\n  const classes = useStyles();\n\n  const loadMore = () => {\n    setLoaded((prevState) => {\n      const loadedMessages = prevState + 25;\n      return loadedMessages <= messages.length ? loadedMessages : messages.length;\n    });\n  };\n\n  const onSubmit = (e) => {\n    e.preventDefault();\n    if (message.trim()) {\n      dispatch(postMessageAction({ createdBy: id, message, timestamp: new Date().getTime() }));\n      setTimeout(() => chatBottomRef.current.scrollIntoView({ behavior: 'smooth' }), 50);\n    }\n    setMessage('');\n  };\n\n  useLayoutEffect(() => {\n    if (messages) {\n      if (window.innerHeight - messagesRef.current.getBoundingClientRect().bottom >= -75) {\n        setTimeout(() => chatBottomRef.current.scrollIntoView({ behavior: 'smooth' }), 50);\n      }\n      setLoaded((prevState) => prevState + 1);\n    }\n  }, [messages]);\n\n  const loadedMessages = useMemo(() => (loaded > 0 ? (messages || []).slice(-loaded) : []), [messages, loaded]);\n\n  return (\n    <div className={classes.container}>\n      {messages && loaded < messages.length && (\n        <Button fullWidth type=\"button\" onClick={loadMore}>\n          Load more\n        </Button>\n      )}\n\n      <div className={classes.messages} ref={messagesRef}>\n        {loadedMessages.map((message, ix) => (\n          <Message\n            key={`by-${message.createdBy}-at-${message.timestamp}`}\n            message={message}\n            isLastMessage={loadedMessages[ix + 1] ? loadedMessages[ix + 1].createdBy !== message.createdBy : true}\n            isFirstMessage={loadedMessages[ix - 1] ? loadedMessages[ix - 1].createdBy !== message.createdBy : true}\n          />\n        ))}\n      </div>\n      <div ref={chatBottomRef} />\n\n      <Toolbar position=\"static\" className={classes.appBar}>\n        <form onSubmit={onSubmit} className={classes.form}>\n          <TextField placeholder=\"Message\" fullWidth value={message} onChange={(e) => setMessage(e.target.value)} />\n          <IconButton type=\"submit\" className={classes.button}>\n            <Send />\n          </IconButton>\n        </form>\n      </Toolbar>\n    </div>\n  );\n};\n\nexport default Chat;\n","import { makeStyles } from '@material-ui/core';\n\nexport const useStyles = makeStyles({\n  wrapper: {\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  button: {\n    marginTop: '.5rem',\n  },\n});\n","import React, { useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport localforage from 'localforage';\nimport PropTypes from 'prop-types';\n\nimport { TextField, Button } from '@material-ui/core';\n\nimport { createUserAction } from 'store/users/actions';\n\nimport { useStyles } from './styles';\n\nconst getUsers = async () => {\n  const users = await localforage.getItem('users');\n  if (!users) {\n    await localforage.setItem('users', []);\n  }\n  return users || [];\n};\n\nconst CreateUser = ({ setId }) => {\n  const dispatch = useDispatch();\n  const [username, setUsername] = useState('');\n  const classes = useStyles();\n\n  const onSubmit = async (e) => {\n    e.preventDefault();\n    const users = await getUsers();\n    const id = Math.max(0, ...users.map(({ id }) => id)) + 1;\n    setId(id);\n    dispatch(createUserAction({ users, user: { username, id } }));\n  };\n\n  return (\n    <div className={classes.wrapper}>\n      <form onSubmit={onSubmit} className={classes.form}>\n        <TextField\n          required\n          label=\"Username\"\n          variant=\"outlined\"\n          value={username}\n          onChange={(e) => setUsername(e.target.value)}\n        />\n        <Button\n          disabled={!username}\n          size=\"large\"\n          color=\"primary\"\n          variant=\"contained\"\n          type=\"submit\"\n          fullWidth\n          className={classes.button}\n        >\n          Enter chat\n        </Button>\n      </form>\n    </div>\n  );\n};\n\nCreateUser.propTypes = {\n  setId: PropTypes.func,\n};\n\nexport default CreateUser;\n","import React, { createContext, useState } from 'react';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core';\n\nimport Chat from 'pages/Chat';\nimport CreateUser from 'pages/CreateUser';\n\nexport const UserIdContext = createContext(null);\n\nconst App = () => {\n  const [id, setId] = useState(null);\n  const theme = createMuiTheme();\n  return (\n    <ThemeProvider theme={theme}>\n      <UserIdContext.Provider value={id}>{id ? <Chat /> : <CreateUser setId={setId} />}</UserIdContext.Provider>\n    </ThemeProvider>\n  );\n};\n\nexport default App;\n","import { takeEvery, put, select } from 'redux-saga/effects';\nimport localforage from 'localforage';\nimport isEqual from 'lodash/isEqual';\n\nimport * as messagesActions from 'store/messages/actions';\nimport { messagesSelector } from 'store/messages/reducer';\n\nfunction* loadMessages() {\n  try {\n    const reduxMessaged = yield select(messagesSelector);\n    const messages = yield localforage.getItem('messages');\n    if (!messages) {\n      yield localforage.setItem('messages', []);\n    }\n\n    const isMessagesEqual = isEqual(messages || [], reduxMessaged);\n\n    if (!isMessagesEqual) {\n      yield put({\n        type: messagesActions.loadMessagesAction.success,\n        payload: messages || [],\n      });\n    }\n  } catch {\n    yield put({ type: messagesActions.loadMessagesAction.failure });\n  }\n}\n\nfunction* postMessage({ payload }) {\n  try {\n    const messages = (yield localforage.getItem('messages')) || [];\n    messages.push(payload);\n    yield localforage.setItem('messages', messages);\n    yield put({ type: messagesActions.postMessageAction.success, payload });\n    yield put(messagesActions.loadMessagesAction());\n  } catch {\n    yield put({ type: messagesActions.postMessageAction.failure });\n  }\n}\n\nexport default function* () {\n  yield takeEvery(messagesActions.postMessageAction.pending, postMessage);\n  yield takeEvery(messagesActions.loadMessagesAction.pending, loadMessages);\n}\n","import { takeEvery, put } from 'redux-saga/effects';\nimport localforage from 'localforage';\n\nimport * as usersActions from 'store/users/actions';\nimport * as messagesActions from 'store/messages/actions';\n\nfunction* createNewUser({ payload }) {\n  try {\n    const { user, users } = payload;\n    yield localforage.setItem('users', users.concat(user));\n    yield put({ type: usersActions.createUserAction.success, payload: users.concat(user) });\n    yield put({ type: messagesActions.loadMessagesAction.pending });\n  } catch {\n    yield put({ type: usersActions.createUserAction.failure });\n  }\n}\n\nexport default function* () {\n  yield takeEvery(usersActions.createUserAction.pending, createNewUser);\n}\n","import { fork } from 'redux-saga/effects';\n\nimport messages from './messages/saga';\nimport users from './users/saga';\n\nexport default function* () {\n  yield* [fork(messages), fork(users)];\n}\n","import { createStore, applyMiddleware, combineReducers } from 'redux';\nimport {\n  createStateSyncMiddleware,\n  initMessageListener,\n  withReduxStateSync,\n  initStateWithPrevTab,\n} from 'redux-state-sync';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport createSagaMiddleware from 'redux-saga';\n\nimport users from './users/reducer';\nimport messages from './messages/reducer';\n\nimport rootSaga from './sagas';\nimport { loadMessagesAction, postMessageAction } from 'store/messages/actions';\nimport { createUserAction } from 'store/users/actions';\n\n// import { assignUserAction } from 'store/users/actions';\n\nconst rootReducer = withReduxStateSync(\n  combineReducers({\n    users,\n    messages,\n  }),\n);\n\nconst config = {\n  // TOGGLE_TODO will not be triggered in other tabs\n  blacklist: [postMessageAction.pending, loadMessagesAction.pending, createUserAction.pending],\n};\n\nconst sagaMiddleware = createSagaMiddleware();\n\nconst middlewares = [createStateSyncMiddleware(config), sagaMiddleware];\n\nexport const store = createStore(rootReducer, {}, composeWithDevTools(applyMiddleware(...middlewares)));\n\nsagaMiddleware.run(rootSaga);\n\ninitMessageListener(store);\ninitStateWithPrevTab(store);\n","import React from 'react';\nimport { Provider } from 'react-redux';\n\nimport AppWrapper from 'pages/AppWrapper';\n\nimport { store } from 'store';\n\nconst App = () => {\n  return (\n    <Provider store={store}>\n      <AppWrapper />\n    </Provider>\n  );\n};\n\nexport default App;\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './pages';\nimport reportWebVitals from './reportWebVitals';\nimport './index.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}